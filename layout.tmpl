<!DOCTYPE html>
<html lang="en">
<style>
    body {
        background: #eee;
    }

    .container {
        width: 40%;
        margin: 10px auto;
    }

    .tag-container {
        border: 2px solid #ccc;
        border-radius: 1px;
        background: #fff;
        display: flex;
        flex-wrap: wrap;
        align-content: flex-start;
        padding: 6px;
        overflow-x: auto;
    }

    .tag-container .tag {
        height: 30px;
        margin: 5px;
        padding: 5px 6px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background: #eee;
        display: flex;
        align-items: center;
        color: #333;
        /* box-shadow: 0 0 4px rgba(0, 0, 0, 0.2), inset 0 1px 1px #fff; */
        cursor: default;
    }

    .tag i {
        font-size: 16px;
        color: #666;
        margin-left: 5px;
    }

    .tag-container input {
        padding: 1px;
        font-size: 16px;
        border: 0;
        outline: none;
        font-family: 'Rubik';
        color: #333;
        flex: 1;
    }
</style>

<head>
    <meta charset="UTF-8">
    <title>{{.PageTitle}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
</head>

<body>
    <div class="container">
        <h1>{{.PageTitle}}</h1>
        <p>tag things</p>
        <table class="table heading" id="inputtable" style="width:500px; border: 1px solid black">
            <tbody>
                <tr style=background-color:#585968;>
                    <td style=color:#ccc>Link</td>
                </tr>
                <tr>
                    <td><input /></td>
                </tr>
                <tr style=background-color:#585968;>
                    <td style=color:#ccc>Tags</td>
                </tr>
                <td>
                    <div class="tag-container ">
                        <input />
                    </div>
                </td>
                <tr>
                    <td>
                        <button class=" btn btn-primary " type=" submit ">Submit</button>
                    </td>
                </tr>
                </tr>
            </tbody>
            <div class="container">
                <br>
                <table class="table table-bordered table-sm border-primary table-striped table-hover " id=" queries ">
                    <thead>
                        <tr>
                            <th>Link</th>
                            <th>Tags</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{ range .Entries }}
                        <tr>
                            <td><a href=" http://{{.Link}} ">{{.Link}} </a>
                            </td>
                            <td>{{ range .Tags }}
                                <a class=" btn btn-primary btn-sm " href=" /search?tag={{.}} ">{{.}}</a>{{ end }}
                            </td>
                        </tr>
                        {{ end }}
                    </tbody>
                </table>
            </div>
            <script src=" https://code.jquery.com/jquery-3.5.1.js "></script>
            <script src=" https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js "></script>
            <script src=" https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js "></script>
            <script src=" https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js "
                integrity=" sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p "
                crossorigin=" anonymous "></script>
            <script>
                $(document).ready(function () {
                    $('#queries').DataTable();
                });
            </script>
            <script>
                const tagContainer = document.querySelector('.tag-container');
                const input = document.querySelector('.tag-container input');

                let tags = [];

                function createTag(label) {
                    const div = document.createElement('div');
                    div.setAttribute('class', 'tag');
                    const span = document.createElement('span');
                    span.innerHTML = label;
                    const closeIcon = document.createElement('i');
                    closeIcon.innerHTML = '[x]';
                    closeIcon.setAttribute('class', 'material-icons');
                    closeIcon.setAttribute('data-item', label);
                    div.appendChild(span);
                    div.appendChild(closeIcon);
                    return div;
                }

                function clearTags() {
                    document.querySelectorAll('.tag').forEach(tag => {
                        tag.parentElement.removeChild(tag);
                    });
                }

                function addTags() {
                    clearTags();
                    tags.slice().reverse().forEach(tag => {
                        tagContainer.prepend(createTag(tag));
                    });
                }

                input.addEventListener('keyup', (e) => {
                    if (e.key === 'Enter') {
                        e.target.value.split(',').forEach(tag => {
                            tags.push(tag);
                        });

                        addTags();
                        input.value = '';
                    }
                });
                document.addEventListener('click', (e) => {
                    console.log(e.target.tagName);
                    if (e.target.tagName === 'I') {
                        const tagLabel = e.target.getAttribute('data-item');
                        const index = tags.indexOf(tagLabel);
                        tags = [...tags.slice(0, index), ...tags.slice(index + 1)];
                        addTags();
                    }
                })

                input.focus();
            </script>

</body>

</html>